(this.webpackJsonplax_medic=this.webpackJsonplax_medic||[]).push([[24],{379:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return ae}));var n=t(194),l=t(86),o=t(11),r=t(32),i=t(0),c=t.n(i),s=t(26),m=t(266),u=t.n(m),d=t(46),g=t(89),p=t(330),f=t(326),b=t(359),h=t(360),x=t(291),E=t.n(x),v=t(293),y=t.n(v),O=t(25),j=t(369),C=t(292),k=t.n(C),w=t(39),N=t(347),S=t(372),_=t(357),R=t(286),D=t.n(R);var I=Object(d.a)((function(e){return{root:{backgroundColor:e.palette.background.paper,minHeight:"85vh",width:"100%",flexGrow:1,position:"relative"}}}));function L(e){var a=e.onlinePersonalsList,t=e.getRoom,n=I(),l=c.a.useState(0),r=Object(o.a)(l,2),i=r[0],s=r[1];return c.a.createElement("div",{className:n.root},c.a.createElement(N.a,{position:"absolute",color:"primary"},c.a.createElement(S.a,{value:i,onChange:function(e,a){t(a),s(a)},variant:"scrollable",scrollButtons:"on","aria-label":"scrollable force tabs example"},a.map((function(e,a){return c.a.createElement(_.a,Object.assign({key:a,value:e.id,label:e.username,icon:c.a.createElement(D.a,null)},(t=e.id,{id:"scrollable-force-tab-".concat(t),"aria-controls":"scrollable-force-tabpanel-".concat(t)})));var t})))),"Liste de derni\xe8re conversation")}var B=t(195),J=t(339),M=t(340),V=t(24),G=t(22),z=t(346),T=t(287),A=t.n(T),H=t(289),P=t.n(H),W=t(288),q=t.n(W),F=t(178),K=t.n(F),Q=t(290),U=t.n(Q),X=Object(d.a)((function(e){return{root:{height:"87vh",width:"100%",flexGrow:1,display:"flex",flexDirection:"column",position:"relative"},header:{position:"relative",zIndex:1,padding:"2px 2px",display:"flex",alignItems:"center",width:"100%"},title:{flex:1},body:{flex:1,overflow:"auto"},messageContainer:{margin:"10px 0px",display:"flex",flexDirection:"column"},messageRight:{padding:"6px 13px",maxWidth:"80%",color:"black",alignSelf:"flex-end !important",backgroundColor:V.a[50]},messageLeft:{padding:"6px 13px",maxWidth:"80%",alignSelf:"flex-start !important",backgroundColor:G.a[200]},form:{padding:"2px 4px",display:"flex",alignItems:"center",width:"100%","& .MuiTextField-root":{margin:e.spacing(.5),flex:1}},iconButton:{padding:10},divider:{height:28,margin:4}}})),Y={type:"text",content:""};function Z(e){var a=e.changeView,t=e.currentRoom,n=e.sendChatMessage,r=X(),s=c.a.useState(),m=Object(o.a)(s,2),u=m[0],d=m[1];c.a.useEffect((function(){console.log("je suis la"),console.log(t),setTimeout((function(){g.current.scrollIntoView({behavior:"smooth"})}),1e3)}),[t]);var g=Object(i.useRef)(null);return c.a.createElement("div",{className:r.root},c.a.createElement(p.a,{className:r.header},c.a.createElement(J.a,{onClick:function(e){return a(0)}},c.a.createElement(A.a,null)),c.a.createElement("div",{className:r.title},c.a.createElement(M.a,null,t.room_name)),c.a.createElement(J.a,{onClick:function(e){return a(2)}},c.a.createElement(q.a,null)),c.a.createElement(z.a,{orientation:"vertical",flexItem:!0}),c.a.createElement(J.a,{onClick:function(e){return a(2)}},c.a.createElement(P.a,null))),c.a.createElement("div",{className:r.body},t.messages!==[]?t.messages.map((function(e,a){var n=new Date(e.date);return c.a.createElement("div",{key:a,className:r.messageContainer},c.a.createElement(p.a,{className:t.room!==e.author.id?r.messageRight:r.messageLeft},c.a.createElement("strong",{className:r.right},e.author.username),c.a.createElement("p",null,e.message),c.a.createElement("p",{style:{textAlign:"right",fontSize:14}},c.a.createElement("small",null,n.toLocaleString()))))})):null,c.a.createElement("div",{ref:g})),c.a.createElement(p.a,{component:"form",className:r.form,onChange:function(e){Y=Object(l.a)(Object(l.a)({},Y),{},{content:e.target.value.trim()})},onSubmit:function(e){e.preventDefault(),console.log(Y),n(Y,t.room),Y={type:"text",content:""},d(""),d(null)}},c.a.createElement(J.a,{className:r.iconButton,"aria-label":"menu"},c.a.createElement(K.a,null)),c.a.createElement(B.a,{required:!0,id:"filled-multiline-flexible",name:"text",label:"Message",multiline:!0,rows:0,value:u,variant:"outlined"}),c.a.createElement(J.a,{type:"submit","aria-label":"directions"},c.a.createElement(U.a,{style:{fontSize:30}}))))}function $(e){var a=e.children,t=e.value,n=e.index,l=Object(r.a)(e,["children","value","index"]);return c.a.createElement(f.a,Object.assign({component:"div",role:"tabpanel",hidden:t!==n,id:"action-tabpanel-".concat(n),"aria-labelledby":"action-tab-".concat(n)},l),t===n&&c.a.createElement(j.a,{p:3},a))}var ee=Object(d.a)((function(e){return{root:{width:"100%",position:"relative",minHeight:"80vh",backgroundColor:"white"},fab:{position:"absolute",bottom:e.spacing(13),right:e.spacing(2)},fabGreen:{color:e.palette.common.white,backgroundColor:O.a[500],"&:hover":{backgroundColor:O.a[600]}}}}));function ae(e){var a=e.addCallBack,t=e.deleteCallBack,r=e.webSocket,m=ee(),d=Object(g.a)(),f=Object(w.b)(),x=c.a.useState(0),v=Object(o.a)(x,2),O=v[0],j=v[1],C=c.a.useState([]),N=Object(o.a)(C,2),S=N[0],_=N[1],R=c.a.useState(),D=Object(o.a)(R,2),I=D[0],B=D[1];Object(i.useEffect)((function(){return console.log(a),a({id:"ChatSpace",type:["chat","online_personals_list","simple_messages"],run:function(e){if(console.log("je suis la depuis chaspace"),console.log(e),"online_personals_list"===e.type)_(e.content);else if("simple_messages"===e.type)B(e.content),j(1);else if("chat"===e.type&&"message"===e.content.type){console.log("message set");var a=Object(l.a)({},I);a.messages=[].concat(Object(n.a)(a.messages),[e.content.message]),console.log(a),B(a)}}}),function(){t("ChatSpace")}}),[]),Object(i.useEffect)((function(){r.send(JSON.stringify({type:"get_online_personals_list"}))}),[I]);var J={enter:d.transitions.duration.enteringScreen,exit:d.transitions.duration.leavingScreen},M=[{color:"primary",className:m.fab,icon:c.a.createElement(E.a,null),label:"Add"},{color:"secondary",className:m.fab,icon:c.a.createElement(k.a,null),label:"Vocal"},{color:"inherit",className:Object(s.a)(m.fab,m.fabGreen),icon:c.a.createElement(y.a,null),label:"Expand"}];return c.a.createElement(p.a,{className:m.root},c.a.createElement(u.a,{axis:"rtl"===d.direction?"x-reverse":"x",index:O,onChangeIndex:function(e){j(e)}},c.a.createElement($,{value:O,index:0,dir:d.direction},c.a.createElement(L,{getRoom:function(e){r.send(JSON.stringify({type:"get_simple_messages",content:{room:e}}))},onlinePersonalsList:S})),c.a.createElement($,{value:O,index:1,dir:d.direction},c.a.createElement(Z,{changeView:j,currentRoom:I,sendChatMessage:function(e,a){var t=new Date;console.log("sendChatMessage"),r.send(JSON.stringify({type:"chat",content:{room_type:"simple",author:f.user.id,to:a,message_type:e.type,message:e.content,message_code:t.getTime()}}))}})),c.a.createElement($,{value:O,index:2,dir:d.direction},"Video")),M.map((function(e,a){return c.a.createElement(b.a,{key:e.color,in:O===a,timeout:J,style:{transitionDelay:"".concat(O===a?J.exit:0,"ms")},unmountOnExit:!0},c.a.createElement(h.a,{"aria-label":e.label,className:e.className,color:e.color},e.icon))})))}}}]);
//# sourceMappingURL=24.25846399.chunk.js.map