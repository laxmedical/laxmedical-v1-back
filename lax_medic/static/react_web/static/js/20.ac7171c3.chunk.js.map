{"version":3,"sources":["assets/img/login1.jpg","axios.js","layouts/Login.js"],"names":["module","exports","baseURL","window","location","hostname","axiosInstance","axios","create","timeout","headers","Authorization","localStorage","getItem","accept","interceptors","response","use","a","error","originalRequest","config","alert","Promise","reject","status","url","href","data","code","statusText","refreshToken","tokenParts","JSON","parse","atob","split","now","Math","ceil","Date","console","log","exp","removeItem","defaults","Copyright","Typography","variant","color","align","Link","getFullYear","useStyles","makeStyles","theme","root","height","image","backgroundImage","bgImage","backgroundRepeat","backgroundColor","palette","type","grey","backgroundSize","backgroundPosition","container","display","flexDirection","alignItems","paper","margin","spacing","maxWidth","avatar","cyan","avatarSuccess","green","avatarWarning","secondary","main","form","width","marginTop","submit","wrapper","position","buttonSuccess","fabProgress","top","left","zIndex","buttonProgress","marginLeft","SignInSide","webSocket","classes","history","useHistory","useLocation","auth","useAuth","React","useState","loading","setLoading","setStatus","saveDataForm","setSaveDataForm","initialFormData","Object","freeze","username","password","amount","weight","weightRange","showPassword","values","setValues","formData","updateFormData","handleChange","e","target","name","value","trim","webSocketLogin","setTimeout","send","stringify","content","onmessage","handleLogin","user","from","state","pathname","signin","replace","setItem","Grid","component","className","CssBaseline","item","xs","sm","md","Paper","elevation","square","Avatar","method","action","onSubmit","preventDefault","post","then","res","access","refresh","catch","TextField","required","fullWidth","id","label","autoComplete","autoFocus","onChange","InputProps","endAdornment","InputAdornment","IconButton","aria-label","onClick","onMouseDown","event","edge","FormControlLabel","control","Checkbox","checked","v","Button","disabled","CircularProgress","size","Box","mt"],"mappings":"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","file":"static/js/20.ac7171c3.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/login1.d7d51fa1.jpg\";","import axios from 'axios';\r\n/* \r\nlet baseURL = `http://${window.location.hostname}:8000/api/`; */\r\nlet baseURL;\r\nif (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {\r\n    baseURL = `http://${window.location.hostname}:8000/api/`;\r\n} else {\r\n    baseURL = 'https://auroracomputing.herokuapp.com/api/';\r\n}\r\n\r\nconst axiosInstance = axios.create({\r\n    baseURL: baseURL,\r\n    timeout: 5000,\r\n    headers: {\r\n        Authorization: localStorage.getItem('access_token') ?\r\n            'JWT ' + localStorage.getItem('access_token') : null,\r\n        'Content-Type': 'application/json',\r\n        accept: 'application/json',\r\n    },\r\n});\r\n\r\naxiosInstance.interceptors.response.use(\r\n    (response) => {\r\n        return response;\r\n    },\r\n    async function(error) {\r\n        const originalRequest = error.config;\r\n\r\n        if (typeof error.response === 'undefined') {\r\n            alert(\r\n                'A server/network error occurred. ' +\r\n                'Looks like CORS might be the problem. ' +\r\n                'Sorry about this - we will get it fixed shortly.'\r\n            );\r\n            return Promise.reject(error);\r\n        }\r\n\r\n        if (\r\n            error.response.status === 401 &&\r\n            originalRequest.url === baseURL + 'token/refresh/'\r\n        ) {\r\n            window.location.href = '/login/';\r\n            return Promise.reject(error);\r\n        }\r\n\r\n        if (\r\n            error.response.data.code === 'token_not_valid' &&\r\n            error.response.status === 401 &&\r\n            error.response.statusText === 'Unauthorized'\r\n        ) {\r\n            const refreshToken = localStorage.getItem('refresh_token');\r\n\r\n            if (refreshToken) {\r\n                const tokenParts = JSON.parse(atob(refreshToken.split('.')[1]));\r\n\r\n                // exp date in token is expressed in seconds, while now() returns milliseconds:\r\n                const now = Math.ceil(Date.now() / 1000);\r\n                console.log(tokenParts.exp);\r\n\r\n                if (tokenParts.exp > now) {\r\n                    console.log('--- refresh ---')\r\n                        /* return axiosInstance\r\n                            .post('/token/refresh/', { refresh: refreshToken })\r\n                            .then((response) => {\r\n                                localStorage.setItem('access_token', response.data.access);\r\n                                localStorage.setItem('refresh_token', response.data.refresh);\r\n\r\n                                axiosInstance.defaults.headers['Authorization'] =\r\n                                    'JWT ' + response.data.access;\r\n                                originalRequest.headers['Authorization'] =\r\n                                    'JWT ' + response.data.access;\r\n\r\n                                return axiosInstance(originalRequest);\r\n                            })\r\n                            .catch((err) => {\r\n                                console.log(err);\r\n                            }); */\r\n                } else {\r\n                    console.log('Refresh token is expired', tokenParts.exp, now);\r\n                    localStorage.removeItem('access_token');\r\n                    localStorage.removeItem('refresh_token');\r\n                    axiosInstance.defaults.headers['Authorization'] = null;\r\n                    window.location.href = '/';\r\n                }\r\n            } else {\r\n                console.log('Refresh token not available.');\r\n                window.location.href = '/login/';\r\n            }\r\n        }\r\n\r\n        // specific error handling done elsewhere\r\n        return Promise.reject(error);\r\n    }\r\n);\r\n\r\nexport default axiosInstance;","import React, { useState } from 'react';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport Button from '@material-ui/core/Button';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Link from '@material-ui/core/Link';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport Box from '@material-ui/core/Box';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\n\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport InputAdornment from '@material-ui/core/InputAdornment';\r\nimport Visibility from '@material-ui/icons/Visibility';\r\nimport VisibilityOff from '@material-ui/icons/VisibilityOff';\r\n\r\n\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport SuccessIcon from '@material-ui/icons/Check';\r\nimport PersonIcon from '@material-ui/icons/PersonTwoTone';\r\n\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport { green, cyan } from '@material-ui/core/colors';\r\n\r\nimport { useHistory, useLocation } from 'react-router-dom';\r\n\r\nimport axiosInstance from '../axios.js';\r\n\r\nimport bgImage from 'assets/img/login1.jpg';\r\n\r\nimport {useAuth} from '../App'\r\n\r\nfunction Copyright() {\r\n  return (\r\n    <Typography variant=\"body2\" color=\"textSecondary\" align=\"center\">\r\n      {'Copyright © '}\r\n      <Link color=\"inherit\" href=\"\">\r\n        Akelax technologie\r\n      </Link>{' '}\r\n      {new Date().getFullYear()}\r\n      {'.'}\r\n    </Typography>\r\n  );\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    height: '100vh',\r\n  },\r\n  image: {\r\n    backgroundImage: `url(${bgImage})`,\r\n    backgroundRepeat: 'no-repeat',\r\n    backgroundColor:\r\n      theme.palette.type === 'light' ? theme.palette.grey[50] : theme.palette.grey[900],\r\n    backgroundSize: 'cover',\r\n    backgroundPosition: 'center',\r\n  },\r\n  container:{\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n  },\r\n  paper: {\r\n    margin: theme.spacing(8, 4),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    maxWidth: 450\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: cyan[400],\r\n  },\r\n  avatarSuccess: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: green[400],\r\n  },  \r\n  avatarWarning: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main,\r\n  },\r\n  form: {\r\n    width: '100%', // Fix IE 11 issue.\r\n    marginTop: theme.spacing(2),\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2),\r\n  },\r\n  //preload\r\n  wrapper: {\r\n    margin: theme.spacing(1),\r\n    position: 'relative',\r\n  },\r\n  buttonSuccess: {\r\n    backgroundColor: green[500],\r\n    '&:hover': {\r\n      backgroundColor: green[700],\r\n    },\r\n  },\r\n  fabProgress: {\r\n    color: green[500],\r\n    position: 'absolute',\r\n    top: -6,\r\n    left: -6,\r\n    zIndex: 1,\r\n  },\r\n  buttonProgress: {\r\n    color: green[500],\r\n    position: 'absolute',\r\n    top: '50%',\r\n    left: '50%',\r\n    marginTop: -12,\r\n    marginLeft: -12,\r\n  },\r\n}));\r\n\r\nexport default function SignInSide({webSocket, ...props}) {\r\n  const classes = useStyles();\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n\r\n  const auth = useAuth()\r\n\r\n  const [loading, setLoading] = React.useState(false);\r\n  const [status, setStatus] = React.useState('Identifiez-vous');\r\n  const [saveDataForm, setSaveDataForm] = React.useState(true);\r\n\r\n\tconst initialFormData = Object.freeze({\r\n\t\tusername: '',\r\n\t\tpassword: '',\r\n\t});\r\n\r\n  const [values, setValues] = React.useState({\r\n\t\tamount: '',\r\n\t\tpassword: '',\r\n\t\tweight: '',\r\n\t\tweightRange: '',\r\n\t\tshowPassword: false,\r\n\t  });\r\n\t\r\n\t  const handleClickShowPassword = () => {\r\n\t\tsetValues({ ...values, showPassword: !values.showPassword });\r\n\t  };\r\n\t\r\n\t  const handleMouseDownPassword = (event) => {\r\n\t\tevent.preventDefault();\r\n\t  };\r\n\r\n\tconst [formData, updateFormData] = useState(initialFormData);\r\n\r\n\tconst handleChange = (e) => {\r\n\t\tupdateFormData({\r\n\t\t\t...formData,\r\n\t\t\t[e.target.name]: e.target.value.trim(),\r\n\t\t});\r\n\t};\r\n\r\n\tconst handleSubmit = (e) => {\r\n\t\te.preventDefault();\r\n    if (!loading) {\r\n      setLoading(true);\r\n    }\r\n    \r\n\t\taxiosInstance\r\n\t\t\t.post(`/token/`, {\r\n\t\t\t\tusername: formData.username,\r\n\t\t\t\tpassword: formData.password,\r\n\t\t\t})\r\n\t\t\t.then((res) => {\r\n        console.log('success')\r\n\t\t\t\tlocalStorage.setItem('access_token', res.data.access);\r\n\t\t\t\tlocalStorage.setItem('refresh_token', res.data.refresh);\r\n\t\t\t\taxiosInstance.defaults.headers['Authorization'] =\r\n\t\t\t\t\t'JWT ' + localStorage.getItem('access_token');\r\n        \r\n        webSocketLogin();\r\n\t\t\t}).catch((res) => {\r\n        webSocketLogin();\r\n\t\t\t});\r\n  };\r\n  \r\n  const webSocketLogin = () => {\r\n    setTimeout(() => {\r\n      webSocket.send(JSON.stringify({\r\n      type: 'login',\r\n      content: formData\r\n      }))\r\n    }, 100);\r\n\r\n  webSocket.onmessage = (e)=>{\r\n    const data = JSON.parse(e.data);\r\n    console.log(data)\r\n\r\n    if(data.type === \"login\"){\r\n      console.log(data.content)\r\n\r\n      if(data.status===\"success\"){\r\n        console.log('welcome')\r\n        setStatus(data.status)\r\n        handleLogin(data.content.user)\r\n      }\r\n      else if(data.status === \"not allowed\"){\r\n        setStatus(data.status)\r\n        setLoading(false);       \r\n      }\r\n      else{\r\n        setStatus(data.status)\r\n        console.log(\"vous are not connect\")\r\n        setLoading(false);       \r\n      }\r\n    }\r\n  }\r\n  };\r\n\r\n  const handleLogin = (user)=>{\r\n    let { from } = location.state || { from: { pathname: \"/lax_medic\" } };\r\n    auth.signin(() => {\r\n      setTimeout(() => {\r\n      history.replace(from); \r\n      }, 1000);\r\n      return user;\r\n    });\r\n    if(saveDataForm){      \r\n      localStorage.setItem('azerty', formData.username)\r\n      localStorage.setItem('querty', formData.password)\r\n    }\r\n  }\r\n\r\n  return (\r\n  <div>\r\n    <Grid container component=\"main\" className={classes.root}>\r\n      <CssBaseline />\r\n      <Grid item xs={false} sm={4} md={7} className={classes.image} />\r\n      <Grid item xs={12} sm={8} md={5} component={Paper} elevation={6} square>\r\n        <div className={classes.container}>\r\n        <div className={classes.paper}>\r\n          {\r\n            status === 'Identifiez-vous'\r\n              ? <>\r\n                  <Avatar className={classes.avatar}>\r\n                    <PersonIcon />\r\n                  </Avatar>\r\n                  <Typography component=\"p\" variant=\"h5\">\r\n                    {status}\r\n                  </Typography>\r\n                </>\r\n              : status === 'success'\r\n                  ? <>\r\n                      <Avatar className={classes.avatarSuccess}>\r\n                        <SuccessIcon />\r\n                      </Avatar>\r\n                      <Typography component=\"p\" variant=\"h5\">\r\n                        Bienvenu(e) !!!\r\n                      </Typography>\r\n                    </>\r\n                  : status === 'not allowed'\r\n                      ? <>\r\n                          <Avatar className={classes.avatarWarning}>\r\n                            <LockOutlinedIcon />\r\n                          </Avatar>\r\n                          <Typography component=\"p\" variant=\"h5\">\r\n                            Vous êtes pas permi d'entrer\r\n                          </Typography>\r\n                        </>\r\n                      : <>\r\n                          <Avatar className={classes.avatarWarning}>\r\n                            <LockOutlinedIcon />\r\n                          </Avatar>\r\n                          <Typography component=\"p\" variant=\"h5\">\r\n                            Identifiant incorrect\r\n                          </Typography>\r\n                        </>\r\n          }\r\n          <form className={classes.form}  method=\"POST\" action=\".\" onSubmit={handleSubmit}>\r\n            <TextField\r\n              variant=\"outlined\"\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              id=\"username\"\r\n              label=\"Votre nom\"\r\n              name=\"username\"\r\n              autoComplete=\"username\"\r\n              autoFocus\r\n              onChange={handleChange}\r\n            />\r\n            <TextField\r\n              variant=\"outlined\"\r\n              margin=\"normal\"\r\n              required\r\n              fullWidth\r\n              name=\"password\"\r\n              label=\"Password\"\r\n              type={values.showPassword ? 'text' : 'password'}\r\n              id=\"password\"\r\n              autoComplete=\"current-password\"\r\n              onChange={handleChange}\r\n              InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                <IconButton\r\n                  aria-label=\"toggle password visibility\"\r\n                  onClick={handleClickShowPassword}\r\n                  onMouseDown={handleMouseDownPassword}\r\n                  edge=\"end\"\r\n                >\r\n                  {values.showPassword ? <Visibility /> : <VisibilityOff />}\r\n                </IconButton>\r\n                </InputAdornment>)\r\n              }}\r\n            />\r\n            <FormControlLabel\r\n              control={<Checkbox checked={saveDataForm} onChange={()=> setSaveDataForm(v=>!v)} color=\"primary\" name='remember' />}\r\n              label=\"se rappeler de moi\"\r\n            />\r\n            <Button\r\n              type=\"submit\"\r\n              fullWidth\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              disabled={loading}\r\n              className={classes.submit}\r\n            >{loading && <CircularProgress size={24} className={classes.buttonProgress} />}\r\n              Se connecter\r\n            </Button>\r\n            <Grid container>\r\n              <Grid item xs>\r\n                <Link href=\"#\" variant=\"body2\">\r\n                  Forgot password?\r\n                </Link>\r\n              </Grid>\r\n              <Grid item>\r\n                <Link href=\"#\" variant=\"body2\">\r\n                  {\"Don't have an account? Sign Up\"}\r\n                </Link>\r\n              </Grid>\r\n            </Grid>\r\n            <Box mt={5}>\r\n              <Copyright />\r\n            </Box>\r\n          </form>\r\n        </div>\r\n        </div>\r\n      </Grid>\r\n    </Grid>\r\n  </div>\r\n  );\r\n}"],"sourceRoot":""}